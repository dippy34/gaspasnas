<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"a24e512fa2","applicationID":"11183949","transactionName":"clgKEUANWw4GSx1BRlRBDQBFERgFAlRXQmtBRQETWwdATQZUUFRQ","queueTime":1,"applicationTime":65,"agent":""}</script>
<script type="text/javascript">(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]},feature_flags:["soft_nav"]};(window.NREUM||(NREUM={})).loader_config={licenseKey:"a24e512fa2",applicationID:"11183949",browserID:"58960994"};;/*! For license information please see nr-loader-rum-1.308.0.min.js.LICENSE.txt */
(()=>{var e,t,r={163:(e,t,r)=>{"use strict";r.d(t,{j:()=>E});var n=r(384),i=r(1741);var a=r(2555);r(860).K7.genericEvents;const s="experimental.resources",o="register",c=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var d=r(2614),u=r(944),l=r(8122);const f="[data-nr-mask]",g=e=>(0,l.a)(e,(()=>{const e={feature_flags:[],experimental:{allow_registered_children:!1,resources:!1},mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{ajax:{deny_list:void 0,block_internal:!0,enabled:!0,autoStart:!0},api:{get allow_registered_children(){return e.feature_flags.includes(o)||e.experimental.allow_registered_children},set allow_registered_children(t){e.experimental.allow_registered_children=t},duplicate_registered_data:!1},browser_consent_mode:{enabled:!1},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},get feature_flags(){return e.feature_flags},set feature_flags(t){e.feature_flags=t},generic_events:{enabled:!0,autoStart:!0},harvest:{interval:30},jserrors:{enabled:!0,autoStart:!0},logging:{enabled:!0,autoStart:!0},metrics:{enabled:!0,autoStart:!0},obfuscate:void 0,page_action:{enabled:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,autoStart:!0},performance:{capture_marks:!1,capture_measures:!1,capture_detail:!0,resources:{get enabled(){return e.feature_flags.includes(s)||e.experimental.resources},set enabled(t){e.experimental.resources=t},asset_types:[],first_party_domains:[],ignore_newrelic:!0}},privacy:{cookies_enabled:!0},proxy:{assets:void 0,beacon:void 0},session:{expiresMs:d.wk,inactiveMs:d.BB},session_replay:{autoStart:!0,enabled:!1,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,fix_stylesheets:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){c(t)?e.mask_selector="".concat(t,",").concat(f):""===t||null===t?e.mask_selector=f:(0,u.R)(5,t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){c(t)?e.block_selector+=",".concat(t):""!==t&&(0,u.R)(6,t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,u.R)(7,t)}},session_trace:{enabled:!0,autoStart:!0},soft_navigations:{enabled:!0,autoStart:!0},spa:{enabled:!0,autoStart:!0},ssl:void 0,user_actions:{enabled:!0,elementAttributes:["id","className","tagName","type"]}}})());var p=r(6154),m=r(9324);let h=0;const v={buildEnv:m.F3,distMethod:m.Xs,version:m.xv,originTime:p.WN},b={consented:!1},y={appMetadata:{},get consented(){return this.session?.state?.consent||b.consented},set consented(e){b.consented=e},customTransaction:void 0,denyList:void 0,disabled:!1,harvester:void 0,isolatedBacklog:!1,isRecording:!1,loaderType:void 0,maxBytes:3e4,obfuscator:void 0,onerror:void 0,ptid:void 0,releaseIds:{},session:void 0,timeKeeper:void 0,registeredEntities:[],jsAttributesMetadata:{bytes:0},get harvestCount(){return++h}},_=e=>{const t=(0,l.a)(e,y),r=Object.keys(v).reduce((e,t)=>(e[t]={value:v[t],writable:!1,configurable:!0,enumerable:!0},e),{});return Object.defineProperties(t,r)};var w=r(5701);const x=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};var R=r(7836),k=r(3241);const A={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},S=e=>(0,l.a)(e,A),T=new Set;function E(e,t={},r,s){let{init:o,info:c,loader_config:d,runtime:u={},exposed:l=!0}=t;if(!c){const e=(0,n.pV)();o=e.init,c=e.info,d=e.loader_config}e.init=g(o||{}),e.loader_config=S(d||{}),c.jsAttributes??={},p.bv&&(c.jsAttributes.isWorker=!0),e.info=(0,a.D)(c);const f=e.init,m=[c.beacon,c.errorBeacon];T.has(e.agentIdentifier)||(f.proxy.assets&&(x(f.proxy.assets),m.push(f.proxy.assets)),f.proxy.beacon&&m.push(f.proxy.beacon),e.beacons=[...m],function(e){const t=(0,n.pV)();Object.getOwnPropertyNames(i.W.prototype).forEach(r=>{const n=i.W.prototype[r];if("function"!=typeof n||"constructor"===n)return;let a=t[r];e[r]&&!1!==e.exposed&&"micro-agent"!==e.runtime?.loaderType&&(t[r]=(...t)=>{const n=e[r](...t);return a?a(...t):n})})}(e),(0,n.US)("activatedFeatures",w.B)),u.denyList=[...f.ajax.deny_list||[],...f.ajax.block_internal?m:[]],u.ptid=e.agentIdentifier,u.loaderType=r,e.runtime=_(u),T.has(e.agentIdentifier)||(e.ee=R.ee.get(e.agentIdentifier),e.exposed=l,(0,k.W)({agentIdentifier:e.agentIdentifier,drained:!!w.B?.[e.agentIdentifier],type:"lifecycle",name:"initialize",feature:void 0,data:e.config})),T.add(e.agentIdentifier)}},384:(e,t,r)=>{"use strict";r.d(t,{NT:()=>s,US:()=>u,Zm:()=>o,bQ:()=>d,dV:()=>c,pV:()=>l});var n=r(6154),i=r(1863),a=r(1910);const s={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function o(){return n.gm.NREUM||(n.gm.NREUM={}),void 0===n.gm.newrelic&&(n.gm.newrelic=n.gm.NREUM),n.gm.NREUM}function c(){let e=o();return e.o||(e.o={ST:n.gm.setTimeout,SI:n.gm.setImmediate||n.gm.setInterval,CT:n.gm.clearTimeout,XHR:n.gm.XMLHttpRequest,REQ:n.gm.Request,EV:n.gm.Event,PR:n.gm.Promise,MO:n.gm.MutationObserver,FETCH:n.gm.fetch,WS:n.gm.WebSocket},(0,a.i)(...Object.values(e.o))),e}function d(e,t){let r=o();r.initializedAgents??={},t.initializedAt={ms:(0,i.t)(),date:new Date},r.initializedAgents[e]=t}function u(e,t){o()[e]=t}function l(){return function(){let e=o();const t=e.info||{};e.info={beacon:s.beacon,errorBeacon:s.errorBeacon,...t}}(),function(){let e=o();const t=e.init||{};e.init={...t}}(),c(),function(){let e=o();const t=e.loader_config||{};e.loader_config={...t}}(),o()}},782:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewTiming},860:(e,t,r)=>{"use strict";r.d(t,{$J:()=>u,K7:()=>c,P3:()=>d,XX:()=>i,Yy:()=>o,df:()=>a,qY:()=>n,v4:()=>s});const n="events",i="jserrors",a="browser/blobs",s="rum",o="browser/logs",c={ajax:"ajax",genericEvents:"generic_events",jserrors:i,logging:"logging",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},d={[c.pageViewEvent]:1,[c.pageViewTiming]:2,[c.metrics]:3,[c.jserrors]:4,[c.spa]:5,[c.ajax]:6,[c.sessionTrace]:7,[c.softNav]:8,[c.sessionReplay]:9,[c.logging]:10,[c.genericEvents]:11},u={[c.pageViewEvent]:s,[c.pageViewTiming]:n,[c.ajax]:n,[c.spa]:n,[c.softNav]:n,[c.metrics]:i,[c.jserrors]:i,[c.sessionTrace]:a,[c.sessionReplay]:a,[c.logging]:o,[c.genericEvents]:"ins"}},944:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var n=r(3241);function i(e,t){"function"==typeof console.debug&&(console.debug("New Relic Warning: https://github.com/newrelic/newrelic-browser-agent/blob/main/docs/warning-codes.md#".concat(e),t),(0,n.W)({agentIdentifier:null,drained:null,type:"data",name:"warn",feature:"warn",data:{code:e,secondary:t}}))}},1687:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>d,Ze:()=>f,x3:()=>u});var n=r(3241),i=r(7836),a=r(3606),s=r(860),o=r(2646);const c={};function d(e,t){const r={staged:!1,priority:s.P3[t]||0};l(e),c[e].get(t)||c[e].set(t,r)}function u(e,t){e&&c[e]&&(c[e].get(t)&&c[e].delete(t),p(e,t,!1),c[e].size&&g(e))}function l(e){if(!e)throw new Error("agentIdentifier required");c[e]||(c[e]=new Map)}function f(e="",t="feature",r=!1){if(l(e),!e||!c[e].get(t)||r)return p(e,t);c[e].get(t).staged=!0,g(e)}function g(e){const t=Array.from(c[e]);t.every(([e,t])=>t.staged)&&(t.sort((e,t)=>e[1].priority-t[1].priority),t.forEach(([t])=>{c[e].delete(t),p(e,t)}))}function p(e,t,r=!0){const s=e?i.ee.get(e):i.ee,c=a.i.handlers;if(!s.aborted&&s.backlog&&c){if((0,n.W)({agentIdentifier:e,type:"lifecycle",name:"drain",feature:t}),r){const e=s.backlog[t],r=c[t];if(r){for(let t=0;e&&t<e.length;++t)m(e[t],r);Object.entries(r).forEach(([e,t])=>{Object.values(t||{}).forEach(t=>{t[0]?.on&&t[0]?.context()instanceof o.y&&t[0].on(e,t[1])})})}}s.isolatedBacklog||delete c[t],s.backlog[t]=null,s.emit("drain-"+t,[])}}function m(e,t){var r=e[1];Object.values(t[r]||{}).forEach(t=>{var r=e[0];if(t[0]===r){var n=t[1],i=e[3],a=e[2];n.apply(i,a)}})}},1738:(e,t,r)=>{"use strict";r.d(t,{U:()=>g,Y:()=>f});var n=r(3241),i=r(9908),a=r(1863),s=r(944),o=r(5701),c=r(3969),d=r(8362),u=r(860),l=r(4261);function f(e,t,r,a){const f=a||r;!f||f[e]&&f[e]!==d.d.prototype[e]||(f[e]=function(){(0,i.p)(c.xV,["API/"+e+"/called"],void 0,u.K7.metrics,r.ee),(0,n.W)({agentIdentifier:r.agentIdentifier,drained:!!o.B?.[r.agentIdentifier],type:"data",name:"api",feature:l.Pl+e,data:{}});try{return t.apply(this,arguments)}catch(e){(0,s.R)(23,e)}})}function g(e,t,r,n,s){const o=e.info;null===r?delete o.jsAttributes[t]:o.jsAttributes[t]=r,(s||null===r)&&(0,i.p)(l.Pl+n,[(0,a.t)(),t,r],void 0,"session",e.ee)}},1741:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(944),i=r(4261);class a{#e(e,...t){if(this[e]!==a.prototype[e])return this[e](...t);(0,n.R)(35,e)}addPageAction(e,t){return this.#e(i.hG,e,t)}register(e){return this.#e(i.eY,e)}recordCustomEvent(e,t){return this.#e(i.fF,e,t)}setPageViewName(e,t){return this.#e(i.Fw,e,t)}setCustomAttribute(e,t,r){return this.#e(i.cD,e,t,r)}noticeError(e,t){return this.#e(i.o5,e,t)}setUserId(e,t=!1){return this.#e(i.Dl,e,t)}setApplicationVersion(e){return this.#e(i.nb,e)}setErrorHandler(e){return this.#e(i.bt,e)}addRelease(e,t){return this.#e(i.k6,e,t)}log(e,t){return this.#e(i.$9,e,t)}start(){return this.#e(i.d3)}finished(e){return this.#e(i.BL,e)}recordReplay(){return this.#e(i.CH)}pauseReplay(){return this.#e(i.Tb)}addToTrace(e){return this.#e(i.U2,e)}setCurrentRouteName(e){return this.#e(i.PA,e)}interaction(e){return this.#e(i.dT,e)}wrapLogger(e,t,r){return this.#e(i.Wb,e,t,r)}measure(e,t){return this.#e(i.V1,e,t)}consent(e){return this.#e(i.Pv,e)}}},1863:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{t:()=>n})},1910:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});var n=r(944);const i=new Map;function a(...e){return e.every(e=>{if(i.has(e))return i.get(e);const t="function"==typeof e?e.toString():"",r=t.includes("[native code]"),a=t.includes("nrWrapper");return r||a||(0,n.R)(64,e?.name||t),i.set(e,r),r})}},2555:(e,t,r)=>{"use strict";r.d(t,{D:()=>o,f:()=>s});var n=r(384),i=r(8122);const a={beacon:n.NT.beacon,errorBeacon:n.NT.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0};function s(e){try{return!!e.licenseKey&&!!e.errorBeacon&&!!e.applicationID}catch(e){return!1}}const o=e=>(0,i.a)(e,a)},2614:(e,t,r)=>{"use strict";r.d(t,{BB:()=>s,H3:()=>n,g:()=>d,iL:()=>c,tS:()=>o,uh:()=>i,wk:()=>a});const n="NRBA",i="SESSION",a=144e5,s=18e5,o={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},d={OFF:0,FULL:1,ERROR:2}},2646:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});class n{constructor(e){this.contextId=e}}},2843:(e,t,r)=>{"use strict";r.d(t,{G:()=>a,u:()=>i});var n=r(3878);function i(e,t=!1,r,i){(0,n.DD)("visibilitychange",function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)},r,i)}function a(e,t,r){(0,n.sp)("pagehide",e,t,r)}},3241:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(6154);const i="newrelic";function a(e={}){try{n.gm.dispatchEvent(new CustomEvent(i,{detail:e}))}catch(e){}}},3606:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});var n=r(9908);a.on=s;var i=a.handlers={};function a(e,t,r,a){s(a||n.d,i,e,t,r)}function s(e,t,r,i,a){a||(a="feature"),e||(e=n.d);var s=t[a]=t[a]||{};(s[r]=s[r]||[]).push([e,i])}},3878:(e,t,r)=>{"use strict";function n(e,t){return{capture:e,passive:!1,signal:t}}function i(e,t,r=!1,i){window.addEventListener(e,t,n(r,i))}function a(e,t,r=!1,i){document.addEventListener(e,t,n(r,i))}r.d(t,{DD:()=>a,jT:()=>n,sp:()=>i})},3969:(e,t,r)=>{"use strict";r.d(t,{TZ:()=>n,XG:()=>o,rs:()=>i,xV:()=>s,z_:()=>a});const n=r(860).K7.metrics,i="sm",a="cm",s="storeSupportabilityMetrics",o="storeEventMetrics"},4234:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(7836),i=r(1687);class a{constructor(e,t){this.agentIdentifier=e,this.ee=n.ee.get(e),this.featureName=t,this.blocked=!1}deregisterDrain(){(0,i.x3)(this.agentIdentifier,this.featureName)}}},4261:(e,t,r)=>{"use strict";r.d(t,{$9:()=>d,BL:()=>o,CH:()=>g,Dl:()=>_,Fw:()=>y,PA:()=>h,Pl:()=>n,Pv:()=>k,Tb:()=>l,U2:()=>a,V1:()=>R,Wb:()=>x,bt:()=>b,cD:()=>v,d3:()=>w,dT:()=>c,eY:()=>p,fF:()=>f,hG:()=>i,k6:()=>s,nb:()=>m,o5:()=>u});const n="api-",i="addPageAction",a="addToTrace",s="addRelease",o="finished",c="interaction",d="log",u="noticeError",l="pauseReplay",f="recordCustomEvent",g="recordReplay",p="register",m="setApplicationVersion",h="setCurrentRouteName",v="setCustomAttribute",b="setErrorHandler",y="setPageViewName",_="setUserId",w="start",x="wrapLogger",R="measure",k="consent"},5289:(e,t,r)=>{"use strict";r.d(t,{GG:()=>s,Qr:()=>c,sB:()=>o});var n=r(3878),i=r(6389);function a(){return"undefined"==typeof document||"complete"===document.readyState}function s(e,t){if(a())return e();const r=(0,i.J)(e),s=setInterval(()=>{a()&&(clearInterval(s),r())},500);(0,n.sp)("load",r,t)}function o(e){if(a())return e();(0,n.DD)("DOMContentLoaded",e)}function c(e){if(a())return e();(0,n.sp)("popstate",e)}},5607:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});const n=(0,r(9566).bz)()},5701:(e,t,r)=>{"use strict";r.d(t,{B:()=>a,t:()=>s});var n=r(3241);const i=new Set,a={};function s(e,t){const r=t.agentIdentifier;a[r]??={},e&&"object"==typeof e&&(i.has(r)||(t.ee.emit("rumresp",[e]),a[r]=e,i.add(r),(0,n.W)({agentIdentifier:r,loaded:!0,drained:!0,type:"lifecycle",name:"load",feature:void 0,data:e})))}},6154:(e,t,r)=>{"use strict";r.d(t,{OF:()=>c,RI:()=>i,WN:()=>u,bv:()=>a,eN:()=>l,gm:()=>s,mw:()=>o,sb:()=>d});var n=r(1863);const i="undefined"!=typeof window&&!!window.document,a="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),s=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),o=Boolean("hidden"===s?.document?.visibilityState),c=/iPad|iPhone|iPod/.test(s.navigator?.userAgent),d=c&&"undefined"==typeof SharedWorker,u=((()=>{const e=s.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);Array.isArray(e)&&e.length>=2&&e[1]})(),Date.now()-(0,n.t)()),l=()=>"undefined"!=typeof PerformanceNavigationTiming&&s?.performance?.getEntriesByType("navigation")?.[0]?.responseStart},6389:(e,t,r)=>{"use strict";function n(e,t=500,r={}){const n=r?.leading||!1;let i;return(...r)=>{n&&void 0===i&&(e.apply(this,r),i=setTimeout(()=>{i=clearTimeout(i)},t)),n||(clearTimeout(i),i=setTimeout(()=>{e.apply(this,r)},t))}}function i(e){let t=!1;return(...r)=>{t||(t=!0,e.apply(this,r))}}r.d(t,{J:()=>i,s:()=>n})},6630:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewEvent},7699:(e,t,r)=>{"use strict";r.d(t,{It:()=>a,KC:()=>o,No:()=>i,qh:()=>s});var n=r(860);const i=16e3,a=1e6,s="SESSION_ERROR",o={[n.K7.logging]:!0,[n.K7.genericEvents]:!1,[n.K7.jserrors]:!1,[n.K7.ajax]:!1}},7836:(e,t,r)=>{"use strict";r.d(t,{P:()=>o,ee:()=>c});var n=r(384),i=r(8990),a=r(2646),s=r(5607);const o="nr@context:".concat(s.W),c=function e(t,r){var n={},s={},u={},l=!1;try{l=16===r.length&&d.initializedAgents?.[r]?.runtime.isolatedBacklog}catch(e){}var f={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,a){!1!==a&&(a=!0);if(c.aborted&&!i)return;t&&a&&t.emit(e,r,n);var o=g(n);m(e).forEach(e=>{e.apply(o,r)});var d=v()[s[e]];d&&d.push([f,e,r,o]);return o},get:h,listeners:m,context:g,buffer:function(e,t){const r=v();if(t=t||"feature",f.aborted)return;Object.entries(e||{}).forEach(([e,n])=>{s[n]=t,t in r||(r[t]=[])})},abort:function(){f._aborted=!0,Object.keys(f.backlog).forEach(e=>{delete f.backlog[e]})},isBuffering:function(e){return!!v()[s[e]]},debugId:r,backlog:l?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:l};return Object.defineProperty(f,"aborted",{get:()=>{let e=f._aborted||!1;return e||(t&&(e=t.aborted),e)}}),f;function g(e){return e&&e instanceof a.y?e:e?(0,i.I)(e,o,()=>new a.y(o)):new a.y(o)}function p(e,t){n[e]=m(e).concat(t)}function m(e){return n[e]||[]}function h(t){return u[t]=u[t]||e(f,t)}function v(){return f.backlog}}(void 0,"globalEE"),d=(0,n.Zm)();d.ee||(d.ee=c)},8122:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var n=r(944);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.R)(3);if(!t||"object"!=typeof t)return(0,n.R)(4);const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),a=0===Object.keys(r).length?e:r;for(let s in a)if(void 0!==e[s])try{if(null===e[s]){r[s]=null;continue}Array.isArray(e[s])&&Array.isArray(t[s])?r[s]=Array.from(new Set([...e[s],...t[s]])):"object"==typeof e[s]&&"object"==typeof t[s]?r[s]=i(e[s],t[s]):r[s]=e[s]}catch(e){r[s]||(0,n.R)(1,e)}return r}catch(e){(0,n.R)(2,e)}}},8362:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});var n=r(9566),i=r(1741);class a extends i.W{agentIdentifier=(0,n.LA)(16)}},8374:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},8990:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},9324:(e,t,r)=>{"use strict";r.d(t,{F3:()=>i,Xs:()=>a,xv:()=>n});const n="1.308.0",i="PROD",a="CDN"},9566:(e,t,r)=>{"use strict";r.d(t,{LA:()=>o,bz:()=>s});var n=r(6154);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function a(e,t){return e?15&e[t]:16*Math.random()|0}function s(){const e=n.gm?.crypto||n.gm?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map(e=>"x"===e?a(t,r++).toString(16):"y"===e?(3&a()|8).toString(16):e).join("")}function o(e){const t=n.gm?.crypto||n.gm?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const s=[];for(var o=0;o<e;o++)s.push(a(r,i++).toString(16));return s.join("")}},9908:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,p:()=>i});var n=r(7836).ee.get("handle");function i(e,t,r,i,a){a?(a.buffer([e],i),a.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,i),a.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,r)=>(i.f[r](e,t),t),[])),i.u=e=>"nr-rum-1.308.0.min.js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.308.0.PROD:",i.l=(r,n,a,s)=>{if(e[r])e[r].push(n);else{var o,c;if(void 0!==a)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var l=d[u];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+a){o=l;break}}if(!o){c=!0;var f={296:"sha512-+MIMDsOcckGXa1EdWHqFNv7P+JUkd5kQwCBr3KE6uCvnsBNUrdSt4a/3/L4j4TxtnaMNjHpza2/erNQbpacJQA=="};(o=document.createElement("script")).charset="utf-8",i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+a),o.src=r,0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous"),f[s]&&(o.integrity=f[s])}e[r]=[n];var g=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach(e=>e(n)),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=g.bind(null,o.onerror),o.onload=g.bind(null,o.onload),c&&document.head.appendChild(o)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={374:0,840:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise((r,i)=>n=e[t]=[r,i]);r.push(n[2]=a);var s=i.p+i.u(t),o=new Error;i.l(s,r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed: ("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,n[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[s,o,c]=r,d=0;if(s.some(t=>0!==e[t])){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(c)c(i)}for(t&&t(r);d<s.length;d++)a=s[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self["webpackChunk:NRBA-1.308.0.PROD"]=self["webpackChunk:NRBA-1.308.0.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(8374);var e=i(8362),t=i(860);const r=Object.values(t.K7);var n=i(163);var a=i(9908),s=i(1863),o=i(4261),c=i(1738);var d=i(1687),u=i(4234),l=i(5289),f=i(6154),g=i(944),p=i(384);const m=e=>f.RI&&!0===e?.privacy.cookies_enabled;function h(e){return!!(0,p.dV)().o.MO&&m(e)&&!0===e?.session_trace.enabled}var v=i(6389),b=i(7699);class y extends u.W{constructor(e,t){super(e.agentIdentifier,t),this.agentRef=e,this.abortHandler=void 0,this.featAggregate=void 0,this.loadedSuccessfully=void 0,this.onAggregateImported=new Promise(e=>{this.loadedSuccessfully=e}),this.deferred=Promise.resolve(),!1===e.init[this.featureName].autoStart?this.deferred=new Promise((t,r)=>{this.ee.on("manual-start-all",(0,v.J)(()=>{(0,d.Ak)(e.agentIdentifier,this.featureName),t()}))}):(0,d.Ak)(e.agentIdentifier,t)}importAggregator(e,t,r={}){if(this.featAggregate)return;const n=async()=>{let n;await this.deferred;try{if(m(e.init)){const{setupAgentSession:t}=await i.e(296).then(i.bind(i,3305));n=t(e)}}catch(e){(0,g.R)(20,e),this.ee.emit("internal-error",[e]),(0,a.p)(b.qh,[e],void 0,this.featureName,this.ee)}try{if(!this.#t(this.featureName,n,e.init))return(0,d.Ze)(this.agentIdentifier,this.featureName),void this.loadedSuccessfully(!1);const{Aggregate:i}=await t();this.featAggregate=new i(e,r),e.runtime.harvester.initializedAggregates.push(this.featAggregate),this.loadedSuccessfully(!0)}catch(e){(0,g.R)(34,e),this.abortHandler?.(),(0,d.Ze)(this.agentIdentifier,this.featureName,!0),this.loadedSuccessfully(!1),this.ee&&this.ee.abort()}};f.RI?(0,l.GG)(()=>n(),!0):n()}#t(e,r,n){if(this.blocked)return!1;switch(e){case t.K7.sessionReplay:return h(n)&&!!r;case t.K7.sessionTrace:return!!r;default:return!0}}}var _=i(6630),w=i(2614),x=i(3241);class R extends y{static featureName=_.T;constructor(e){var t;super(e,_.T),this.setupInspectionEvents(e.agentIdentifier),t=e,(0,c.Y)(o.Fw,function(e,r){"string"==typeof e&&("/"!==e.charAt(0)&&(e="/"+e),t.runtime.customTransaction=(r||"http://custom.transaction")+e,(0,a.p)(o.Pl+o.Fw,[(0,s.t)()],void 0,void 0,t.ee))},t),this.importAggregator(e,()=>i.e(296).then(i.bind(i,3943)))}setupInspectionEvents(e){const t=(t,r)=>{t&&(0,x.W)({agentIdentifier:e,timeStamp:t.timeStamp,loaded:"complete"===t.target.readyState,type:"window",name:r,data:t.target.location+""})};(0,l.sB)(e=>{t(e,"DOMContentLoaded")}),(0,l.GG)(e=>{t(e,"load")}),(0,l.Qr)(e=>{t(e,"navigate")}),this.ee.on(w.tS.UPDATE,(t,r)=>{(0,x.W)({agentIdentifier:e,type:"lifecycle",name:"session",data:r})})}}class k extends e.d{constructor(e){var t;(super(),f.gm)?(this.features={},(0,p.bQ)(this.agentIdentifier,this),this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(R),(0,n.j)(this,e,e.loaderType||"agent"),t=this,(0,c.Y)(o.cD,function(e,r,n=!1){if("string"==typeof e){if(["string","number","boolean"].includes(typeof r)||null===r)return(0,c.U)(t,e,r,o.cD,n);(0,g.R)(40,typeof r)}else(0,g.R)(39,typeof e)},t),function(e){(0,c.Y)(o.Dl,function(t,r=!1){if("string"!=typeof t&&null!==t)return void(0,g.R)(41,typeof t);const n=e.info.jsAttributes["enduser.id"];r&&null!=n&&n!==t?(0,a.p)(o.Pl+"setUserIdAndResetSession",[t],void 0,"session",e.ee):(0,c.U)(e,"enduser.id",t,o.Dl,!0)},e)}(this),function(e){(0,c.Y)(o.nb,function(t){if("string"==typeof t||null===t)return(0,c.U)(e,"application.version",t,o.nb,!1);(0,g.R)(42,typeof t)},e)}(this),function(e){(0,c.Y)(o.d3,function(){e.ee.emit("manual-start-all")},e)}(this),function(e){(0,c.Y)(o.Pv,function(t=!0){if("boolean"==typeof t){if((0,a.p)(o.Pl+o.Pv,[t],void 0,"session",e.ee),e.runtime.consented=t,t){const t=e.features.page_view_event;t.onAggregateImported.then(e=>{const r=t.featAggregate;e&&!r.sentRum&&r.sendRum()})}}else(0,g.R)(65,typeof t)},e)}(this),this.run()):(0,g.R)(21)}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}get api(){return this}run(){try{const e=function(e){const t={};return r.forEach(r=>{t[r]=!!e[r]?.enabled}),t}(this.init),n=[...this.desiredFeatures];n.sort((e,r)=>t.P3[e.featureName]-t.P3[r.featureName]),n.forEach(r=>{if(!e[r.featureName]&&r.featureName!==t.K7.pageViewEvent)return;if(r.featureName===t.K7.spa)return void(0,g.R)(67);const n=function(e){switch(e){case t.K7.ajax:return[t.K7.jserrors];case t.K7.sessionTrace:return[t.K7.ajax,t.K7.pageViewEvent];case t.K7.sessionReplay:return[t.K7.sessionTrace];case t.K7.pageViewTiming:return[t.K7.pageViewEvent];default:return[]}}(r.featureName).filter(e=>!(e in this.features));n.length>0&&(0,g.R)(36,{targetFeature:r.featureName,missingDependencies:n}),this.features[r.featureName]=new r(this)})}catch(e){(0,g.R)(22,e);for(const e in this.features)this.features[e].abortHandler?.();const t=(0,p.Zm)();delete t.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return t.ee.get(this.agentIdentifier).abort(),!1}}}var A=i(2843),S=i(782);class T extends y{static featureName=S.T;constructor(e){super(e,S.T),f.RI&&((0,A.u)(()=>(0,a.p)("docHidden",[(0,s.t)()],void 0,S.T,this.ee),!0),(0,A.G)(()=>(0,a.p)("winPagehide",[(0,s.t)()],void 0,S.T,this.ee)),this.importAggregator(e,()=>i.e(296).then(i.bind(i,2117))))}}var E=i(3969);class I extends y{static featureName=E.TZ;constructor(e){super(e,E.TZ),f.RI&&document.addEventListener("securitypolicyviolation",e=>{(0,a.p)(E.xV,["Generic/CSPViolation/Detected"],void 0,this.featureName,this.ee)}),this.importAggregator(e,()=>i.e(296).then(i.bind(i,9623)))}}new k({features:[R,T,I],loaderType:"lite"})})()})();</script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Whack Your Boss! - Play on Kongregate</title>
  <meta name="robots" contents="noindex">
  
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="wJ/BaICy9DFmwNAzkGbJBdr935pp9+kaTJcUywnD3QXDr7C5yZL5X9CI5vLKgQQxAQEC/q/+MqqfhT5XUQbesA==" />
  
  
  <link rel="stylesheet" media="all" href="https://cdn1.kongcdn.com/compiled-assets/sitewide-956665fd44fd51393f21e42fce62a4c5b1586a01e6c679888e8ac4886bf1d7dd.css" />
  
  <style>
    #overlay {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      z-index: 9999998 !important;
      background-color: rgba(0, 0, 0, 0.8) !important;
    }
    #lightbox {
      position: fixed !important;
      top: 50% !important;
      left: 50% !important;
      margin-left: 0 !important;
      margin-top: 0 !important;
      transform: translate(-50%, -50%) !important;
      z-index: 9999999 !important;
      max-height: 90vh !important;
      max-width: 90vw !important;
      overflow: visible !important;
    }
    /* Ensure iframe content doesn't scroll - scrolling handled by parent page */
    html, body.embed-layout {
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
      height: 100% !important;
    }
    /* Allow scrolling for specific tall games (Kanoapps) */
    body.embed-layout.allow-scroll {
      overflow: auto !important;
    }
  </style>
  
  <script src="https://cdn4.kongcdn.com/compiled-assets/sitewide_javascripts-bb8f84dc68baba8273816fa52d29aecb533f14fdeb9befa51aa8669c559bb845.js" data-turbo-track="reload"></script>
  <script>
//<![CDATA[
      var active_user = new ActiveUser({"domain":"kongregate.com","single_cdn_domain":"cdn1.kongcdn.com","trusted_domain":"internal.kongregate.com","kong_user_data":{"username":"Guest","id":0,"chat_username":"Guest_bf6363284c6aecc8f8ff3bc56462d74a","chat_password":"64b0fc509dde42d5cd0d9e5df3104341","mobile_user_agent":false,"generated_at":1769725291000,"version":1,"country_code":"US","in_eu_consent_country":false,"age_of_consent":13,"gameplays_count":0,"ratings_count":0,"level":null,"last_levelup_at":null,"first_visit_date":null,"kong_source":null,"split_treatments":{"feature_roll":{}},"kred_buyer_type":"non-buyer","current_locale":"en","current_locale_is_default":true,"current_preffered_locale":"en","underage":null,"hide_rate_this_game_tab":false,"botd_badge_id":3217,"botd_name":"It Takes Two To Solve","botd_description":"Solve all the puzzles","botd_icon_uri":"/badge_icons/0000/6433/2020-04-09-215583.png","botd_game_uri":"http://www.kongregate.com/en/games/RawEgg/dumo","botd_game_name":"DUMO","botd_reward_points":5,"user_agent":{"browser":"Chrome","version":"120.0.0.0","platform":"Windows"}},"load_toolbar":true,"game_page":true,"chip_grant":false}),
          page_data = {};

//]]>
</script>
  <script src="https://cdn1.kongcdn.com/compiled-assets/application-d0afa324054491a3ca94ffc474f0460395fe4b6c0e9c4bd7d36b2a76a67ea2e2.js" data-turbo-track="reload"></script>
  <script src="https://cdn1.kongcdn.com/compiled-assets/holodeck_javascripts-d991fc307826cf2afbcc85dad64cb49565955662e83015e2d08ab9d467cdbd2f.js" data-turbo-track="reload"></script>
  <script src="https://cdn3.kongcdn.com/compiled-assets/kongregate_api-249af50a9e9fd78428bffa05be974ca4733959763d9727d62787a18b9a806b4a.js" data-turbo-track="reload"></script>
</head>

<body class="embed-layout">
  <script>
    // Check if current URL matches games that need scrolling enabled
    (function() {
      var tallGames = [
        'kanoapps/mob-wars-la-cosa-nostra',
        'kanoapps/zombie-slayer',
        'kanoapps/pirate-clan',
        'kanoapps/viking-clan'
      ];
      var currentPath = window.location.pathname.toLowerCase();
      for (var i = 0; i < tallGames.length; i++) {
        if (currentPath.indexOf(tallGames[i]) !== -1) {
          document.body.classList.add('allow-scroll');
          break;
        }
      }
    })();
  </script>
    <script>
//<![CDATA[

    var metricTracker = new MetricTracker({googleAnalytics:
                                            {analyticsCode: 'GTM-589V58Z',
                                             trackPageView: true,
                                             setDomain: true,
                                             maxEventTime: 60000}});

//]]>
</script>

<script src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
<script>
//<![CDATA[
  // Wait for googletag to be available before initializing kong_ads
  function initializeKongAds() {
    if (typeof googletag === 'undefined') {
      setTimeout(initializeKongAds, 50);
      return;
    }
    
    videoegg = false;
    kong_url_host = "www.kongregate.com";

    window.kong_ads = new KongDFPAds({
      networkId: "1019038",
      publisherId: "ca-pub-2543721856801245",
      renderingMode: 'sync',
      refreshAds: true
    });
    var ka = kong_ads; // for pages that still reference ka

    kong_ads.setTargeting({"norollover":"false","production":"true","videoegg":"false","game":"whack-your","game_id":"73983","category":"puzzle","gamegroup":["flash"],"tags":["Point And ","Funny","Action","Hidden Obj","Fighting","Mouse Only","5 Minute","Devil","Interactiv","Educationa"],"shootorial":"false"});

    if (window.active_user !== undefined) {
      kong_ads.setTargeting('registered', active_user.isAuthenticated() ? 'true' : 'false').
        setTargeting('premium', active_user.isPremium() ? 'true' : 'false').
        setTargeting('gameplays', "" + (active_user.gameplaysCount() + 1));

      active_user.addRunWhenAuthenticatedObserver(function(user) {
        kong_ads.setTargeting('kred_type', active_user.kredBuyerType());
        kong_ads.setTargeting('fb_status', active_user.facebookStatus());
      });
    }
  }
  
  initializeKongAds();

//]]>
</script>
<script src="https://unpkg.com/@ruffle-rs/ruffle"></script>
<script>
window.FAYE_CONFIG = {
  KWAK_RAILS_URL:   "https://kwak-rails.kongregate.com",
  KWAK_SERVICE_URL: "https://kwak-faye.kongregate.com"
}

// Essential JavaScript variables for game embedding
swfobject.switchOffAutoHideShow();
active_user.setAnalyticsInfo(encodeURIComponent(active_user.documentLocationSearchQuery().analytics_environment || "live"), {});
// Use regular game path (not preview) for MTX checkout URLs to work correctly
active_user.setGame(73983, "/en/games/WhackYourBosscom/whack-your-boss", {"user_vars_sig":"MSMWWUaYOAHO9T9QE7r4/w==","user_vars":"[]","game_auth_token":"84983c60f7daadc1cb8698621f802c0d9f9a3c3c295c810748fb048115c186ec","flash_postmessage":true,"mtx_api":false,"shared_content_api":true,"chat_api":false,"game_type":"flash","game_name":"Whack Your Boss!","has_alternate_file":false,"game_permalink":"whack-your-boss","requires_flash":true});

// =============================================================================
// Preview UI Auth Method Overrides
// =============================================================================
// Override auth-related methods to use postMessage communication with the parent
// preview page instead of the old lightbox system. This allows the embed iframe
// to trigger the new auth modal in the parent window.
// =============================================================================

(function() {
  // Helper to send auth request to parent window
  function requestAuthFromParent(tab) {
    if (window.parent && window.parent !== window) {
      console.log('[Preview Embed] Requesting auth modal from parent, tab:', tab);
      window.parent.postMessage({ type: 'openAuthModal', tab: tab }, '*');
    } else {
      console.warn('[Preview Embed] No parent window available for auth request');
    }
  }

  // Store original methods for potential fallback
  var originalActivateInlineLogin = active_user.activateInlineLogin.bind(active_user);
  var originalCapturedSelectorWrapper = active_user.capturedSelectorWrapper.bind(active_user);
  var originalOccasionallyShowRegistrationLightbox = active_user.occasionallyShowRegistrationLightbox.bind(active_user);

  // Override activateInlineLogin to use parent's auth modal
  active_user.activateInlineLogin = function(additional_query_parameters, registration_first) {
    var tab = registration_first ? 'signup' : 'login';
    requestAuthFromParent(tab);
  };

  // Override capturedSelectorWrapper to use parent's auth modal
  active_user.capturedSelectorWrapper = function(event, fn, registration_first) {
    var is_fn = typeof fn === 'function';
    
    if (active_user.isAuthenticated()) {
      // User is logged in, execute original function
      if (is_fn) {
        return fn(event);
      }
    } else {
      // User is not logged in, request auth from parent
      var tab = registration_first ? 'signup' : 'login';
      requestAuthFromParent(tab);
      
      // Save the function to execute after auth
      if (is_fn) {
        active_user.saveCapturedFunction(fn.bind(null, event));
      }
      
      // Prevent the original action
      if (event && event.preventDefault) {
        event.preventDefault();
        event.stopPropagation();
      }
      return false;
    }
  };

  // Override occasionallyShowRegistrationLightbox to use parent's auth modal
  active_user.occasionallyShowRegistrationLightbox = function() {
    if (active_user.getsRegistrationLightbox()) {
      requestAuthFromParent('signup');
    }
  };

  console.log('[Preview Embed] Auth method overrides installed - will use parent auth modal');
})();

var channel_id = uuid.v4();

// Initialize parent window kongregateAPI for iframe access (matching original page behavior)
window.kongregateAPI = window.kongregateAPI || new KongregateAPI();
// Process flash variables that iframe will access via parent window lookup
window.kongregateAPI._processParam('kongregate_username', active_user.username());
window.kongregateAPI._processParam('kongregate_user_id', active_user.id());
window.kongregateAPI._processParam('kongregate_game_auth_token', active_user.gameAuthToken());
window.kongregateAPI._processParam('kongregate_game_id', 73983);
window.kongregateAPI._processParam('kongregate_host', 'https://www.kongregate.com');
window.kongregateAPI._processParam('kongregate_game_url', "/en/games/WhackYourBosscom/whack-your-boss/embed");
window.kongregateAPI._processParam('kongregate_channel_id', channel_id);
window.kongregateAPI._processParam('kongregate_debug_level', 2);

// Update debug level immediately after setting params
if (window.kongregateAPI._updateDebugLevel) {
  window.kongregateAPI._updateDebugLevel();
}

// Handle postMessage requests from iframe for flash variables
window.addEventListener('message', function(event) {
  if (event.data === 'kongregate_request_params' && event.source && window.kongregateAPI) {
    var flashVars = window.kongregateAPI.flashVarsObject();
    event.source.postMessage(JSON.stringify({
      type: 'params',
      data: flashVars
    }), '*');
  }
}, false);

// Also add listener to top window in case that's where the message goes
if (window.top && window.top !== window) {
  try {
    window.top.addEventListener('message', function(event) {
      if (event.data === 'kongregate_request_params' && event.source && window.kongregateAPI) {
        var flashVars = window.kongregateAPI.flashVarsObject();
        event.source.postMessage(JSON.stringify({
          type: 'params',
          data: flashVars
        }), '*');
      }
    }, false);
  } catch (e) {
    // Cross-origin access blocked
  }
}

// Set up kongregateAPI in the top window so nested gameIframe can access it
// The gameIframe's _processParentKongregateParams walks up to 'top' window
if (window.top && window.top !== window) {
  try {
    window.top.kongregateAPI = window.top.kongregateAPI || window.kongregateAPI;
    // Copy flash variables to top window's kongregateAPI
    if (window.top.kongregateAPI !== window.kongregateAPI) {
      var flashVars = window.kongregateAPI.flashVarsObject();
      for (var key in flashVars) {
        window.top.kongregateAPI._processParam(key, flashVars[key]);
      }
    }
  } catch (e) {
    // Cross-origin access blocked, fall back to postMessage
  }
}

function konduitToHolodeck() {
  var arg = arguments[0];
  if( 'undefined' == typeof(holodeck) || !holodeck.ready) {
    setTimeout(function() { konduitToHolodeck(arg); }, 500);
  } else {
    setTimeout(function() { holodeck.konduitEvent(arg) }, 0);
  }
}
</script>


<div id="game" class="game-embed-container" style="width: 100%; height: 100vh; margin: 0; padding: 0;">
  <div id="authenticated_users_only_message" style="display: none;"></div>
  <div id="authenticated_users_only_game" style="display: block; width: 100%; height: 100%;">
    <span id="gameiframe"></span><script>
//<![CDATA[
    var iframeConfig = {"auto_resize":null,"iframe_url":'https://game73983.konggames.com/games/WhackYourBosscom/whack-your-boss/frame/' + channel_id + '/?kongregate_host=www.kongregate.com',"alternate_game_file_url":null,"game_width":750,"game_height":500,"max_game_width":null,"max_game_height":null,"game_left":0,"game_top":13,"style_updates":"","iframe_class":"dont_hide","host":"https://www.kongregate.com","api_host":"https://api.kongregate.com","api_path":"https://chat.kongregate.com/flash/API_AS3_5a1d8c231ff1d223d7181f3900f58126.swf","preview":false,"game_permalink":"whack-your-boss","game_id":73983,"game_url":"http://www.kongregate.com/en/games/WhackYourBosscom/whack-your-boss","game_version":1268333340,"flash_var_prefix":"kv_","post_message":true,"iframe_host":"https://game73983.konggames.com","game_host":"https://chat.kongregate.com","channel_id":encodeURIComponent(channel_id),"svid":null,"game_type":"flash"};
    var iframeUrl = 'https://game73983.konggames.com/games/WhackYourBosscom/whack-your-boss/frame/' + channel_id + '/?kongregate_host=www.kongregate.com';
    var gameType = "flash";

//]]>
</script><script>
//<![CDATA[
              gameLoader = {
          loadGame: function(urlOptions) {
                new GameIframe(iframeConfig, urlOptions, channel_id).createGameIframeElement();

          }
        }

      function activateGame(urlOptions) {
        if (activateGame._alreadyActivated) {
          Kongregate.Log.warn('Game already activated, ignoring call');
          return;
        }

        if (activateGame._preloaded) {
          var element = document.getElementById('gameiframe');
          element.style.visibility = null;

        }else{
          if (!urlOptions) {
              urlOptions = '';
          }
            gameLoader.loadGame(urlOptions);
        }
        activateGame._alreadyActivated = true;
        document.fire('game:activated');

      };

      function preloadGame(urlOptions) {

        var chromium = !!window.chrome;
        if(!chromium){
          return;
        }

        if (preloadGame._alreadyPreloaded) {
          Kongregate.Log.warn('Game already preloaded, ignoring call');
          return;
        }
        preloadGame._alreadyPreloaded = true;

        if (!urlOptions) {
          urlOptions = '';
        }

        iframeConfig.style_updates = 'visibility:hidden';
        activateGame._preloaded = true;
        gameLoader.loadGame(urlOptions);
      };


//]]>
</script>
  </div>
  
  
  <div id="chat_container" class="chatholder" style="display: none;">
  </div>
  
  <div class="user_connection hinted_value" style="display: none;">
    <span id="chat_connected_indicator" class="spritegame spriteall" style="display:none;">Connected</span>
    <span id="chat_limited_connection_indicator" class="spritegame spriteall" style="display:none;">Limited connection</span>
    <span id="chat_disconnected_indicator" class="spritegame spriteall">Disconnected</span>
  </div>
  
  <script type="text/html" id="google_duration_tracking_iframe">
    <iframe src="/duration_tracking_content.html" style="display:none;" />
  </script>
  <span id="google_duration_tracking_iframe_target"></span>
  
  <script id="accomplishments_tab_pane_template" type="text/html">
    <div id="accomplishments_tab_content">
    </div>
    <div id="high_scores_container" style="display:none;">
      <div id="high_scores">
      </div>
    </div>
    <div id="high_scores_spinner" style="display:none;">
      <span class="spinner spinner_big">loading</span>
    </div>
  </script>
  
  <script type="text/html" id="game_tab_pane_template">
    <!-- Empty game tab template for preview - holodeck compatibility only -->
    <div style="display: none;"></div>
  </script>
  
  <script type="text/html" id="chat_notification_received_private_message">
    <p class="whisper received_whisper">
      <span class="username chat_message_window_username">#{username}</span><span class="separator">: </span>
        <span class="message">
          Want to join my private chat room?
          <a href='#' class='yes'>Join</a>/<a href='#' class='no'>Ignore</a>
        </span>
        <span class="clear">
      </span>
    </p>
  </script>
</div>


<script>
  // Set up embed iframe styles - scrolling handled by parent page per spec
  document.addEventListener('DOMContentLoaded', function() {
    const style = document.createElement('style');
    style.textContent = `
      /* No scrolling in embed iframe - parent page handles scrolling */
      html, body {
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
        height: 100% !important;
      }
      
      /* Make gameiframe fill its container */
      #gameiframe {
        position: relative !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
      }
      
      /* Ensure parent containers have full height */
      #authenticated_users_only_game {
        width: 100% !important;
        height: 100% !important;
      }
      
      /* Container sizes to content */
      .game-embed-container {
        position: relative;
        width: 100%;
        height: 100%;
      }
    `;
    document.head.appendChild(style);
    
    // Define isFlashGame at the top level so it's accessible everywhere
    const isFlashGame = true;
    
    // Modern Video Ads - Handled by Stimulus controller
    // The modern-video-ads controller will automatically:
    // 1. Check suppression rules
    // 2. Show pre-roll ad if applicable
    // 3. Call activateGame() when complete
    
    // Override activateGame to show fullscreen button only after game is fully loaded
    const originalActivateGame = window.activateGame;
    window.activateGame = function() {
      // Call the original activateGame function
      if (originalActivateGame) {
        originalActivateGame.apply(this, arguments);
      }
      
      // Reset legacy holodeck positioning on gameiframe after it's created
      // The GameIframe class sets inline styles (top: 63px, left: 185px) that we need to override
      setTimeout(function() {
        const gameIframe = document.getElementById('gameiframe');
        if (gameIframe) {
          gameIframe.style.position = 'relative';
          gameIframe.style.top = '0';
          gameIframe.style.left = '0';
          gameIframe.style.width = '100%';
          gameIframe.style.height = '100%';
        }
        parent.postMessage({ type: 'gameActivated' }, '*');
      }, 100); // Short delay to ensure iframe is created
    };
    
    // Notify parent that game embed is ready
    parent.postMessage({ type: 'gameEmbedReady' }, '*');
    
    // Listen for messages from preview page
    window.addEventListener('message', function(event) {
      // Handle activateGame trigger from parent
      if (event.data && event.data.type === 'activateGame') {
        if (typeof activateGame === 'function') {
          activateGame();
        }
        return;
      }
      
      // Handle purchase result from new item checkout modal (relayed from top window)
      if (event.data && event.data.type === 'purchaseResult') {
        console.log('[Embed] Received purchaseResult from parent:', event.data);
        try {
          if (typeof holodeck !== 'undefined' && holodeck.konduit) {
            var resultData = {
              success: event.data.success || false
            };
            if (event.data.purchase_id) {
              resultData.purchase_id = event.data.purchase_id;
            }
            holodeck.konduit().dispatchEvent({
              type: 'purchase_result',
              data: resultData
            });
            console.log('[Embed] Dispatched purchase_result to game via holodeck');
          }
        } catch (e) {
          console.error('[Embed] Error dispatching purchase_result:', e);
        }
        return;
      }
      
      if (event.data && event.data.type === 'triggerGameResize') {
        console.log('Embed iframe processing triggerGameResize - activating game');
        
        // Directly activate the game
        // Holodeck is guaranteed to be ready because parent waited for holodeckReady message
        if (typeof activateGame === 'function') {
          activateGame();
        } else {
          console.error('activateGame function not found!');
        }
        
        // Wait for GameIframe creation, then resize based on game's actual dimensions
        setTimeout(function() {
          try {
            // Get game's native dimensions
            const nativeGameWidth = (typeof iframeConfig !== 'undefined' && iframeConfig.max_game_width) ? iframeConfig.max_game_width : 750;
            const nativeGameHeight = (typeof iframeConfig !== 'undefined' && iframeConfig.max_game_height) ? iframeConfig.max_game_height : 500;
            
            // Get available viewport dimensions from parent window
            const parentWidth = event.data.parentWidth || window.parent.innerWidth;
            const parentHeight = event.data.parentHeight || window.parent.innerHeight;
            
            // Calculate maximum available space
            const maxAvailableWidth = Math.min(parentWidth, window.parent.innerWidth - 20);
            const maxAvailableHeight = Math.min(parentHeight, window.parent.innerHeight - 120);
            
            // Get game's maximum allowed dimensions
            const maxGameWidth = 750;
            const maxGameHeight = 500;
            
            // Calculate responsive dimensions that fit within viewport while maintaining aspect ratio
            const gameAspectRatio = nativeGameWidth / nativeGameHeight;
            
            // Scale to fit available space, but respect the game's maximum dimensions
            const widthScale = Math.min(maxAvailableWidth / nativeGameWidth, maxGameWidth / nativeGameWidth);
            const heightScale = Math.min(maxAvailableHeight / nativeGameHeight, maxGameHeight / nativeGameHeight);
            const scale = Math.min(widthScale, heightScale);
            
            let optimalWidth = Math.round(nativeGameWidth * scale);
            let optimalHeight = Math.round(nativeGameHeight * scale);
            
            // Ensure we don't exceed the game's maximum dimensions
            optimalWidth = Math.min(optimalWidth, maxGameWidth);
            optimalHeight = Math.min(optimalHeight, maxGameHeight);
            
            // Ensure minimum dimensions for usability
            const minWidth = Math.min(400, nativeGameWidth);
            const minHeight = Math.min(300, nativeGameHeight);
            
            optimalWidth = Math.max(optimalWidth, minWidth);
            optimalHeight = Math.max(optimalHeight, minHeight);
            
            // Round to avoid fractional pixels
            optimalWidth = Math.round(optimalWidth);
            optimalHeight = Math.round(optimalHeight);
          
          // Don't use GameIframe.setSize as it sets fixed pixel dimensions
          // Instead, use CSS to fill the container
          const iframe = document.getElementById('gameiframe');
          if (iframe) {
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            // Reset legacy holodeck positioning
            iframe.style.position = 'relative';
            iframe.style.top = '0';
            iframe.style.left = '0';
          }
          
          // Send resize message to preview with calculated dimensions
          
            parent.postMessage({
              type: 'gameResize',
              width: optimalWidth,
              height: optimalHeight,
              source: 'GameIframe_dynamic_resize'
            }, '*');
          } catch (error) {
            // Send fallback resize message with default dimensions
            parent.postMessage({
              type: 'gameResize',
              width: 750,
              height: 500,
              source: 'GameIframe_fallback_resize'
            }, '*');
          }
        }, 500);
      }
      
      // Handle window resize messages from parent
      if (event.data && event.data.type === 'resizeGameIframe') {
        // Resize the #gameiframe element to fill its container
        const gameIframe = document.getElementById('gameiframe');
        if (gameIframe) {
          // Use 100% to fill container - the parent preview page controls the container size
          gameIframe.style.width = '100%';
          gameIframe.style.height = '100%';
          // Reset legacy holodeck positioning - game should fill its container
          gameIframe.style.position = 'relative';
          gameIframe.style.top = '0';
          gameIframe.style.left = '0';
        }
        
        // Also resize containing elements to fill their containers
        const gameWrapper = document.getElementById('game_wrapper');
        if (gameWrapper) {
          gameWrapper.style.width = '100%';
          gameWrapper.style.height = '100%';
        }
        
        const gameHolder = document.getElementById('gameholder');
        if (gameHolder) {
          gameHolder.style.width = '100%';
          gameHolder.style.height = '100%';
        }
      }
    });
  });
</script>

<script>
//<![CDATA[
  var holodeck;

//]]>
</script>
<script>
  // Listen for auth success from parent window and reload embed to get authenticated user info
  var authReloadInProgress = false;
  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'auth:success') {
      // Only reload if user is currently a guest and we haven't already started a reload
      if (!authReloadInProgress && !active_user.isAuthenticated()) {
        authReloadInProgress = true;
        console.log('[Preview Embed] User logged in, reloading embed iframe with authenticated user');
        // Reload the embed iframe to reinitialize with authenticated user
        window.location.reload();
      } else {
        console.log('[Preview Embed] Ignoring auth:success - already authenticated or reload in progress');
      }
    }
  });

  holodeck = new Holodeck({"active_user":active_user,"channel_id":encodeURIComponent(channel_id),"chat_host":"of1.kongregate.com","chat_proxy_websocket":"wss://chat-proxy.kongregate.com","chat_proxy_bosh":"https://chat-proxy.kongregate.com/http-bind/","game_id":73983,"statistics":[],"achievements":[],"challenges":[],"chat_bootstrap_url":"/en/games/WhackYourBosscom/whack-your-boss/chat.js","holodeck_url":"/en/games/WhackYourBosscom/whack-your-boss/holodeck","accomplishments_bootstrap_url":"/en/games/WhackYourBosscom/whack-your-boss/chat_achievements","sticker_drop_url":"/en/games/WhackYourBosscom/whack-your-boss/sticker_drop","game_path":"/en/games/WhackYourBosscom/whack-your-boss","html_dimensions":{"game_width":750,"game_height":500,"max_game_width":null,"max_game_height":null,"game_left":0,"game_top":13,"chat_width":300,"chat_height":527,"flash_frame_width":1053,"flash_frame_height":553,"game_frame_width":750,"game_frame_height":527,"min_chat_width":300,"min_chat_height":527,"divider_width":3,"quicklinks_height":26,"chat_window_non_content_height":254,"avatar_image_gutter_height":120,"chat_pane_tab_height":41},"login_url":"/en/accounts/new/behind_login.js?game_id=73983","shared_content_type_permalinks":[],"shared_content_type_names":[],"permissions":{"session_lookup_key":null,"no_file_size_limit":null,"chat_api":null,"premium_game":null,"served_from_internal":null,"microtransaction_api":false,"save_shared_content":true,"save_external_shared_content":true,"authenticated_users_only":false,"hide_comments":false,"dont_hide_iframe":true,"shout_api":false,"mass_messages_api":null,"shared_links":null,"disallow_cinematic":false,"disable_instart":null,"guilds_api":null,"generate_guest_characters":false,"allow_script_access":false,"periscope_dashboard":false,"incentivized_web_ads":null,"host_in_top_frame":false,"force_localconnection":false,"truex_web_ads":false},"has_game_specific_forum":false,"multiplayer_game":false,"authenticated_only_shared_content_sorts":["by_own","by_friends"],"in_beta":false,"in_preview":false,"extra_interpolation":false});

  // Store early messages until holodeck is ready
  var earlyMessages = [];
  var holodeckReady = false;
  
  // Add postMessage listener IMMEDIATELY (before holodeck:ready)
  window.addEventListener('message', function(event) {
    if (event.data && event.data.kongregate_type === 'kongregate:api:message') {
      // If holodeck is ready, process immediately
      if (holodeckReady) {
        var konduit = holodeck.konduit();
        if (konduit && konduit.jsAdapter && konduit.jsAdapter.messageConnection) {
          // Manually trigger MessageConnection to process relayed message
          konduit.jsAdapter.messageConnection.onMessageReceived(event);
        }
      } else {
        // Store for later processing
        earlyMessages.push(event);
      }
    }
  });

  // Failsafe: If holodeck:ready doesn't fire in 3 seconds (e.g., Ajax failure for guests),
  // manually fire it so MessageConnection gets set up
  setTimeout(function() {
    if (!holodeckReady) {
      console.log('[Preview Embed] holodeck:ready timeout - forcing initialization');
      document.fire('holodeck:ready');
    }
  }, 3000);

  document.observe('holodeck:ready', function(){
    console.log('[holodeck:ready] Event fired - holodeck is now fully initialized');
    
    // Mark as ready IMMEDIATELY so incoming messages are processed
    holodeckReady = true;
    
    // Notify parent window immediately - no polling needed!
    parent.postMessage({ type: 'holodeckReady' }, '*');
    console.log('[holodeck:ready] Notified parent window - shop will work');
    
    // Wait for lightbox to be available, then set reference
    var setLightboxReference = function() {
      if (typeof lightbox !== 'undefined') {
        holodeck._lightbox_reference = lightbox.prototype;
      } else {
        document.observe('dom:javascript_loaded', function() {
          holodeck._lightbox_reference = lightbox.prototype;
        });
      }
    };
    setLightboxReference();
    
    // Get the actual konduit instance (it's a getter function)
    var konduit = holodeck.konduit();
    
    // Setup konduit if not already done (required for MessageConnection)
    if (!konduit.setupComplete) {
      konduit.setup({
        eventDispatcher: holodeck._event_dispatcher,
        chatHost: holodeck._chat_host,
        chatProxyWebsocket: holodeck._chat_proxy_websocket,
        chatProxyBosh: holodeck._chat_proxy_bosh
      });
    }
    
    // Set holodeck.ready flag (normally done in uiLoaded)
    if (!holodeck.ready) {
      holodeck.ready = true;
    }
    
    // Minimal holodeck initialization for preview embed
    holodeck.loadAdminControls();
    holodeck.loadDeveloperControls();
    
    // Load accomplishments to trigger retroactive Badge of the Day award
    // This calls chat_achievements which checks if user has already earned today's BotD
    if (holodeck.hasAccomplishments() && holodeck.authenticated()) {
      holodeck.loadAccomplishments();
    }
    
    // Setup MessageConnection to send responses to game iframe
    if (konduit.jsAdapter) {
      var mc = konduit.jsAdapter.messageConnection;
      
      // Override sendMessage to send responses to the game iframe (not parent)
      var originalSendMessage = mc.sendMessage.bind(mc);
      mc.sendMessage = function(opcode, params) {
        // Send via original method
        var result = originalSendMessage(opcode, params);
        
        // Send to game iframe (child window)
        var gameIframe = document.getElementById('gameiframe');
        if (gameIframe && gameIframe.contentWindow) {
          var payload = {
            kongregate_type: 'kongregate:api:message',
            opcode: opcode,
            params: params
          };
          gameIframe.contentWindow.postMessage(payload, '*');
        }
        
        return result;
      };
      
      // Process any stored messages that arrived before holodeck was ready
      earlyMessages.forEach(function(event) {
        mc.onMessageReceived(event);
      });
      earlyMessages = [];
    }
    
  });
  
  // Signal to parent window that embed iframe is ready
  window.addEventListener('load', function() {
    if (window.parent !== window) {
      window.parent.postMessage({ type: 'embedIframeReady' }, '*');
    }
  });
</script>


  
  <script>
//<![CDATA[
  try{
    window.lightboxSecureProtocol = "https://";
  }catch(e){}

//]]>
</script>
<div id="overlay" style="display: none;"></div>
<div id="lightbox" class="done" style="display: none;">
  <div id="lbLoadMessage">
    <p id="lightbox_loading_cancel_link">
      <a href="#" onclick="lightbox.prototype.deactivate(); return false;">X</a>
    </p>
    <p>
      Loading <span id="lightbox-indicator" class="spinner" style="display:none" title="loading&hellip;">&#8203;</span>
    </p>
  </div>
</div>

<script type="text/html" id="kongregate_lightbox_wrapper_template">
<div id="kongregate_lightbox_wrapper">
  <div class="header_bar">
    <h3>Kongregate</h3>
    <a onclick="lightbox.prototype.deactivate({});return false" class="close_link" href="/en/games/whackyourbosscom/whack-your-boss/embed">close &#215;</a>
  </div>
  <div id="kongregate_lightbox_iframe_loading_spinner">
    <k-spinner class="text-2xl" theme="dark"></k-spinner>
  </div>
  <iframe id="kongregate_lightbox_wrapper_iframe" src="#{iframe_src}" frameborder="0" onload="$('kongregate_lightbox_iframe_loading_spinner').hide();"></iframe>
</div>
</script>

<script type="text/html" id="kongregate_lightbox_wrapper_template_noframe">
<div id="kongregate_lightbox_wrapper">
  <div class="header_bar">
    <h3>Kongregate</h3>
    <a onclick="lightbox.prototype.deactivate({});return false" class="close_link" href="/en/games/whackyourbosscom/whack-your-boss/embed">close &#215;</a>
  </div>
  <div id="kongregate_lightbox_spinner">
    <k-spinner class="text-2xl" theme="dark"></k-spinner>
  </div>
  <div id="lightbox_form"></div>
</div>
</script>

  
  <script>
//<![CDATA[
  var isJavascriptLoaded = function(url) {
    javascripts.pop();
    if(javascripts.length == 0) {
      document.javascript_loaded = true
      Event.fire(document, 'dom:javascript_loaded');
    }
  }

  javascripts = ['https://cdn1.kongcdn.com/compiled-assets/sitewide_async_javascripts-7d4e7c2182567f1f003e4f2b5e51ee2ddf40e4eec59975e1cf98f19ec9f29125.js'];
  AsyncLoader.load('js', 'https://cdn1.kongcdn.com/compiled-assets/sitewide_async_javascripts-7d4e7c2182567f1f003e4f2b5e51ee2ddf40e4eec59975e1cf98f19ec9f29125.js', isJavascriptLoaded);

  (function() {
    

  }).runWhenReady();

//]]>
</script>
</body>
</html>